{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"03 Dataset | train-val-test split","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyOtpzfgOYc5LbV8qLvrt6HL"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"46513f82b395420388312480e3af99c3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9543a288a4cd4e5cb99db05e16779922","IPY_MODEL_2aa3e888f5324268a0c47230cfaf0c70","IPY_MODEL_4d6839673ee440d9b91f70d5f2c230db"],"layout":"IPY_MODEL_3a4d6f47fee945a89962499d4eb639ed"}},"9543a288a4cd4e5cb99db05e16779922":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9875ef96deec4985acfb0553c95d82f7","placeholder":"​","style":"IPY_MODEL_ba9c3a9a60c743ae9013f3948d0f0d9c","value":"Flattening the indices: 100%"}},"2aa3e888f5324268a0c47230cfaf0c70":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5e081d410c3e4c3f97d45c972ec39e9c","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_03bd636b749444f3aaa0e0afc3e89e02","value":3}},"4d6839673ee440d9b91f70d5f2c230db":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6236ae952af243a1a11d1e6bba62b0d0","placeholder":"​","style":"IPY_MODEL_7e157ce4a16d4082ad67c869e34b68cb","value":" 3/3 [00:00&lt;00:00, 13.77ba/s]"}},"3a4d6f47fee945a89962499d4eb639ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9875ef96deec4985acfb0553c95d82f7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ba9c3a9a60c743ae9013f3948d0f0d9c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5e081d410c3e4c3f97d45c972ec39e9c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"03bd636b749444f3aaa0e0afc3e89e02":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6236ae952af243a1a11d1e6bba62b0d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7e157ce4a16d4082ad67c869e34b68cb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"838ac9f866284e578f0dd6285f894415":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7fdf544a69364dc483f5dbc3d3e1e99f","IPY_MODEL_b2ef03bc8ab94de095c7de4ccac156be","IPY_MODEL_34ecf350716c4499b0300b745a28d2a2"],"layout":"IPY_MODEL_9d72dc93a9d749e7ad8d985e24ddec40"}},"7fdf544a69364dc483f5dbc3d3e1e99f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3e9afc0a0b224c74a288f70df0605335","placeholder":"​","style":"IPY_MODEL_90ea065b919449c6afd336ac730db88e","value":"Flattening the indices: 100%"}},"b2ef03bc8ab94de095c7de4ccac156be":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6240f518fec048609ed1c4a32fc8b93f","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c17d3f95ff19447e98313744c0392be9","value":1}},"34ecf350716c4499b0300b745a28d2a2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_225ddee91302442fbe218598d4c2197a","placeholder":"​","style":"IPY_MODEL_9a8a1e4326ec44aa9ee187ba1bdeb1e0","value":" 1/1 [00:00&lt;00:00,  9.75ba/s]"}},"9d72dc93a9d749e7ad8d985e24ddec40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e9afc0a0b224c74a288f70df0605335":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"90ea065b919449c6afd336ac730db88e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6240f518fec048609ed1c4a32fc8b93f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c17d3f95ff19447e98313744c0392be9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"225ddee91302442fbe218598d4c2197a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a8a1e4326ec44aa9ee187ba1bdeb1e0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2df8bca1949a4131aae9e26cdf78896d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_63575bc058674bbc9567d75a72a22107","IPY_MODEL_b148e19c4d5d4385a94deefb3b2342a1","IPY_MODEL_da858e9474ac4f4f82e39e89e6dc5886"],"layout":"IPY_MODEL_0796f4a18c3743cb835dd60aaeba40d7"}},"63575bc058674bbc9567d75a72a22107":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1a2d9cda627d4bef9091b368bc85e76c","placeholder":"​","style":"IPY_MODEL_46c1b84bca9040cbb39c8c592778a822","value":"Flattening the indices: 100%"}},"b148e19c4d5d4385a94deefb3b2342a1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c6265b6adad54361ae8aacd876a0b121","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_404e93ac437f4c2c8ef3a5482307fb80","value":1}},"da858e9474ac4f4f82e39e89e6dc5886":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_868dc570d13d4d55a892eb0a1be5a819","placeholder":"​","style":"IPY_MODEL_1d3b6760d7834dbb8f09f1ce191a065b","value":" 1/1 [00:00&lt;00:00, 15.35ba/s]"}},"0796f4a18c3743cb835dd60aaeba40d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1a2d9cda627d4bef9091b368bc85e76c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"46c1b84bca9040cbb39c8c592778a822":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c6265b6adad54361ae8aacd876a0b121":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"404e93ac437f4c2c8ef3a5482307fb80":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"868dc570d13d4d55a892eb0a1be5a819":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1d3b6760d7834dbb8f09f1ce191a065b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"934a6aec240b4da792260819cc58e983":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2df0d6f0cd8b4a508f28aeeb5be93b53","IPY_MODEL_772393ef42294a91bd19d3c066d78ef0","IPY_MODEL_a3f947eb47004f7e9284abe1a2e8d022"],"layout":"IPY_MODEL_907b5baa2f0e4646ae66f6581346dc41"}},"2df0d6f0cd8b4a508f28aeeb5be93b53":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_95a372e9bae8409fbb9cfbf041c11f3e","placeholder":"​","style":"IPY_MODEL_d890d4f2982645ffa44aa0a6dc04cbde","value":"Flattening the indices: 100%"}},"772393ef42294a91bd19d3c066d78ef0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_805ac44ad8f540b4937a5016e87c9b92","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fc0c40233f0e4d378c6a061d803e97eb","value":1}},"a3f947eb47004f7e9284abe1a2e8d022":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c1b68d947f954c6d8313ac0454269b37","placeholder":"​","style":"IPY_MODEL_dbb41fce4bd94ec6b86a563c3d733c27","value":" 1/1 [00:00&lt;00:00,  8.07ba/s]"}},"907b5baa2f0e4646ae66f6581346dc41":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"95a372e9bae8409fbb9cfbf041c11f3e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d890d4f2982645ffa44aa0a6dc04cbde":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"805ac44ad8f540b4937a5016e87c9b92":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fc0c40233f0e4d378c6a061d803e97eb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c1b68d947f954c6d8313ac0454269b37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dbb41fce4bd94ec6b86a563c3d733c27":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0cad4f7f6ac74bf9a99341268a8d4684":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2ed64d13eb7d43d9ae9cfde1dd4296f4","IPY_MODEL_8f5c8d1d92eb4c7f9294505f76ab5cf7","IPY_MODEL_03e65e72b40a42d98a53c1c95e786b40"],"layout":"IPY_MODEL_430e16efccdc4aa3a1b9d5f954882615"}},"2ed64d13eb7d43d9ae9cfde1dd4296f4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b24ffa1681c54eb78a61e2ee7af33fed","placeholder":"​","style":"IPY_MODEL_6c600f1391424736b2d346008e4dc984","value":"Flattening the indices: 100%"}},"8f5c8d1d92eb4c7f9294505f76ab5cf7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_09c97fc01a95445f8bbda54f33dd49c0","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3430327f68a54fa79c3d116ac57b71f0","value":1}},"03e65e72b40a42d98a53c1c95e786b40":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_dcaebdf722214915b22f25d1a53a355d","placeholder":"​","style":"IPY_MODEL_1a4c1aa6ba9d4660bbc4038d936a1267","value":" 1/1 [00:00&lt;00:00, 15.52ba/s]"}},"430e16efccdc4aa3a1b9d5f954882615":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b24ffa1681c54eb78a61e2ee7af33fed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c600f1391424736b2d346008e4dc984":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"09c97fc01a95445f8bbda54f33dd49c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3430327f68a54fa79c3d116ac57b71f0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"dcaebdf722214915b22f25d1a53a355d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1a4c1aa6ba9d4660bbc4038d936a1267":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install -q --upgrade transformers datasets tokenizers #huggingface"],"metadata":{"id":"g2hknIYmh23x","executionInfo":{"status":"ok","timestamp":1654041605236,"user_tz":-420,"elapsed":30704,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"3ac734ec-befd-4bdb-b5cd-008af77512a4"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[K     |████████████████████████████████| 4.2 MB 5.1 MB/s \n","\u001b[K     |████████████████████████████████| 346 kB 40.0 MB/s \n","\u001b[K     |████████████████████████████████| 6.6 MB 32.8 MB/s \n","\u001b[K     |████████████████████████████████| 86 kB 3.4 MB/s \n","\u001b[K     |████████████████████████████████| 596 kB 50.7 MB/s \n","\u001b[K     |████████████████████████████████| 1.1 MB 67.3 MB/s \n","\u001b[K     |████████████████████████████████| 86 kB 4.9 MB/s \n","\u001b[K     |████████████████████████████████| 212 kB 53.7 MB/s \n","\u001b[K     |████████████████████████████████| 140 kB 52.8 MB/s \n","\u001b[K     |████████████████████████████████| 127 kB 52.9 MB/s \n","\u001b[K     |████████████████████████████████| 144 kB 49.1 MB/s \n","\u001b[K     |████████████████████████████████| 271 kB 42.9 MB/s \n","\u001b[K     |████████████████████████████████| 94 kB 1.5 MB/s \n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible.\u001b[0m\n","\u001b[?25h"]}]},{"cell_type":"code","execution_count":2,"metadata":{"id":"yGDS017Uhqrh","executionInfo":{"status":"ok","timestamp":1654041614538,"user_tz":-420,"elapsed":9320,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","from datasets import load_dataset, load_metric, DatasetDict, Dataset"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yelPww7wiF5o","executionInfo":{"status":"ok","timestamp":1654041632572,"user_tz":-420,"elapsed":18039,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"0fe2a76d-0155-4e67-824e-c09a440fab11"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["import json\n","from typing import Dict, List\n","\n","\n","def read_jsonlines(file_path: str) -> List[Dict]:\n","    with open(file_path) as fp:\n","        return [json.loads(line) for line in fp.readlines()]\n","\n","\n","train = pd.DataFrame(read_jsonlines(\"/content/drive/MyDrive/Fake news/News-Dataset/ภาษาไทย_LimeSoda/train_v1.jsonl\"))\n","val = pd.DataFrame(read_jsonlines(\"/content/drive/MyDrive/Fake news/News-Dataset/ภาษาไทย_LimeSoda/val_v1.jsonl\"))\n","test = pd.DataFrame(read_jsonlines(\"/content/drive/MyDrive/Fake news/News-Dataset/ภาษาไทย_LimeSoda/test_v1.jsonl\"))"],"metadata":{"id":"9HtpumsuigAB","executionInfo":{"status":"ok","timestamp":1654041638209,"user_tz":-420,"elapsed":5641,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["news = pd.concat([train,val,test], axis = 0).drop('Token Tags',axis=1).rename(columns = {'Document Tag':'tags','Text':'text'}).reset_index(drop=True)\n","news = news[news['tags']!='Undefined']\n","news.reset_index(drop=True)\n","conditions = [(news['tags']=='Fact News'),\n","              (news['tags']=='Fake News')\n","              ]\n","values = [0,1]\n","news['labels'] = np.select(conditions, values)\n","news = news.replace(np.nan, '', regex=True).drop('tags',axis=1)\n","for i in range(news.shape[0]):\n","  news.loc[news.index[i],'text'] = ''.join(news.loc[news.index[i],'text'])\n","news.drop_duplicates(inplace=True)"],"metadata":{"id":"lS1gystDinnr","executionInfo":{"status":"ok","timestamp":1654041640577,"user_tz":-420,"elapsed":2372,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["news.groupby('labels').count()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":143},"id":"XkfbOED6iq9_","executionInfo":{"status":"ok","timestamp":1654041640578,"user_tz":-420,"elapsed":13,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"1fa16cd1-61ea-45d2-d638-268fe856d1c5"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        text\n","labels      \n","0       1540\n","1       1836"],"text/html":["\n","  <div id=\"df-9903c0d0-3890-41b1-bec0-7fa002527d4a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","    </tr>\n","    <tr>\n","      <th>labels</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1540</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1836</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9903c0d0-3890-41b1-bec0-7fa002527d4a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9903c0d0-3890-41b1-bec0-7fa002527d4a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9903c0d0-3890-41b1-bec0-7fa002527d4a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["dataset = Dataset.from_pandas(news)\n","dataset = dataset.remove_columns(['__index_level_0__'])\n","trainvalid_test = dataset.train_test_split(test_size=0.2)\n","train_valid = trainvalid_test['train'].train_test_split(test_size=0.1)\n","train_set = train_valid['train']\n","split_dataset = DatasetDict({\n","    'train': train_valid['train'],\n","    'test': trainvalid_test['test'],\n","    'valid': train_valid['test']})"],"metadata":{"id":"xNAX-0EOiyZh","executionInfo":{"status":"ok","timestamp":1654041640578,"user_tz":-420,"elapsed":10,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["split_dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tazwWO9-i0hR","executionInfo":{"status":"ok","timestamp":1654041640579,"user_tz":-420,"elapsed":11,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"de793c7d-d1ea-4a85-84f6-63f26b74198c"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['text', 'labels'],\n","        num_rows: 2430\n","    })\n","    test: Dataset({\n","        features: ['text', 'labels'],\n","        num_rows: 676\n","    })\n","    valid: Dataset({\n","        features: ['text', 'labels'],\n","        num_rows: 270\n","    })\n","})"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["split_dataset.save_to_disk('/content/drive/MyDrive/Fake news/News-Dataset/dataset')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["46513f82b395420388312480e3af99c3","9543a288a4cd4e5cb99db05e16779922","2aa3e888f5324268a0c47230cfaf0c70","4d6839673ee440d9b91f70d5f2c230db","3a4d6f47fee945a89962499d4eb639ed","9875ef96deec4985acfb0553c95d82f7","ba9c3a9a60c743ae9013f3948d0f0d9c","5e081d410c3e4c3f97d45c972ec39e9c","03bd636b749444f3aaa0e0afc3e89e02","6236ae952af243a1a11d1e6bba62b0d0","7e157ce4a16d4082ad67c869e34b68cb","838ac9f866284e578f0dd6285f894415","7fdf544a69364dc483f5dbc3d3e1e99f","b2ef03bc8ab94de095c7de4ccac156be","34ecf350716c4499b0300b745a28d2a2","9d72dc93a9d749e7ad8d985e24ddec40","3e9afc0a0b224c74a288f70df0605335","90ea065b919449c6afd336ac730db88e","6240f518fec048609ed1c4a32fc8b93f","c17d3f95ff19447e98313744c0392be9","225ddee91302442fbe218598d4c2197a","9a8a1e4326ec44aa9ee187ba1bdeb1e0","2df8bca1949a4131aae9e26cdf78896d","63575bc058674bbc9567d75a72a22107","b148e19c4d5d4385a94deefb3b2342a1","da858e9474ac4f4f82e39e89e6dc5886","0796f4a18c3743cb835dd60aaeba40d7","1a2d9cda627d4bef9091b368bc85e76c","46c1b84bca9040cbb39c8c592778a822","c6265b6adad54361ae8aacd876a0b121","404e93ac437f4c2c8ef3a5482307fb80","868dc570d13d4d55a892eb0a1be5a819","1d3b6760d7834dbb8f09f1ce191a065b"]},"id":"V2UOZuVNi49x","executionInfo":{"status":"ok","timestamp":1654041644280,"user_tz":-420,"elapsed":3708,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"07b41667-09ff-46f8-a60b-9173b910a460"},"execution_count":9,"outputs":[{"output_type":"display_data","data":{"text/plain":["Flattening the indices:   0%|          | 0/3 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"46513f82b395420388312480e3af99c3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Flattening the indices:   0%|          | 0/1 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"838ac9f866284e578f0dd6285f894415"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Flattening the indices:   0%|          | 0/1 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2df8bca1949a4131aae9e26cdf78896d"}},"metadata":{}}]},{"cell_type":"code","source":["train_set = pd.DataFrame(train_set)"],"metadata":{"id":"WgOr3-CvjbU8","executionInfo":{"status":"ok","timestamp":1654041644867,"user_tz":-420,"elapsed":591,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["train_set['th_en'] = [f'=GOOGLETRANSLATE(A{i+2},\"th\",\"en\")' for i in range(train_set.shape[0])]\n","train_set['augmented'] = [f'=GOOGLETRANSLATE(C{i+2},\"en\",\"th\")' for i in range(train_set.shape[0])]"],"metadata":{"id":"erxXRMrOdy75","executionInfo":{"status":"ok","timestamp":1654041644869,"user_tz":-420,"elapsed":14,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["train_set"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"mxM6ezLHhOzg","executionInfo":{"status":"ok","timestamp":1654041644869,"user_tz":-420,"elapsed":13,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"a5191ed6-4892-4c51-c133-0b010d98c64a"},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                   text  labels  \\\n","0     วิธีทำหัวปลีกล้วยน้ำว้ากับสูตรแก้โรคเบาหวาน|||...       1   \n","1     สูงวัยกินถูกหลักโภชนาการสุขภาพดีอายุยืน|||[Kai...       0   \n","2                         ไข่มุกไม่ย่อยแม่จ้าวววแย่แล้ว       1   \n","3     ไม่เชื่อก็ต้องลอง!!สูตรลดน้ำหนักง่ายๆด้วยโซดา+...       1   \n","4     ผีน้อยกลับไทยอีก158รายผงะเจอไข้สูง17รายผลตรวจเ...       0   \n","...                                                 ...     ...   \n","2425  กรีดเลือดประท้วงเสี่ยงอันตรายถึงชีวิตทั้งติดเช...       0   \n","2426  ชอบดื่มกาแฟทุกเช้าไม่ใส่น้ำตาลตอนท้องว่างคือดี...       1   \n","2427         ไข่มุกปลอมจากยางรถยนตแล้วก้หมูหยองปลอมด้วย       1   \n","2428  ศบค.หวั่นธรรมเนียมจกข้าวเหนียวใส่บาตรภาคอีสานเ...       0   \n","2429  ผลิตภัณฑ์บำรุงสายตาดีคอนแทคdcontactดีไม้คะhttp...       1   \n","\n","                                  th_en                          augmented  \n","0        =GOOGLETRANSLATE(A2,\"th\",\"en\")     =GOOGLETRANSLATE(C2,\"en\",\"th\")  \n","1        =GOOGLETRANSLATE(A3,\"th\",\"en\")     =GOOGLETRANSLATE(C3,\"en\",\"th\")  \n","2        =GOOGLETRANSLATE(A4,\"th\",\"en\")     =GOOGLETRANSLATE(C4,\"en\",\"th\")  \n","3        =GOOGLETRANSLATE(A5,\"th\",\"en\")     =GOOGLETRANSLATE(C5,\"en\",\"th\")  \n","4        =GOOGLETRANSLATE(A6,\"th\",\"en\")     =GOOGLETRANSLATE(C6,\"en\",\"th\")  \n","...                                 ...                                ...  \n","2425  =GOOGLETRANSLATE(A2427,\"th\",\"en\")  =GOOGLETRANSLATE(C2427,\"en\",\"th\")  \n","2426  =GOOGLETRANSLATE(A2428,\"th\",\"en\")  =GOOGLETRANSLATE(C2428,\"en\",\"th\")  \n","2427  =GOOGLETRANSLATE(A2429,\"th\",\"en\")  =GOOGLETRANSLATE(C2429,\"en\",\"th\")  \n","2428  =GOOGLETRANSLATE(A2430,\"th\",\"en\")  =GOOGLETRANSLATE(C2430,\"en\",\"th\")  \n","2429  =GOOGLETRANSLATE(A2431,\"th\",\"en\")  =GOOGLETRANSLATE(C2431,\"en\",\"th\")  \n","\n","[2430 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-e8b1a8bb-db07-4537-84e7-9b3ddc3b850c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>labels</th>\n","      <th>th_en</th>\n","      <th>augmented</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>วิธีทำหัวปลีกล้วยน้ำว้ากับสูตรแก้โรคเบาหวาน|||...</td>\n","      <td>1</td>\n","      <td>=GOOGLETRANSLATE(A2,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C2,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>สูงวัยกินถูกหลักโภชนาการสุขภาพดีอายุยืน|||[Kai...</td>\n","      <td>0</td>\n","      <td>=GOOGLETRANSLATE(A3,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C3,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ไข่มุกไม่ย่อยแม่จ้าวววแย่แล้ว</td>\n","      <td>1</td>\n","      <td>=GOOGLETRANSLATE(A4,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C4,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ไม่เชื่อก็ต้องลอง!!สูตรลดน้ำหนักง่ายๆด้วยโซดา+...</td>\n","      <td>1</td>\n","      <td>=GOOGLETRANSLATE(A5,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C5,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ผีน้อยกลับไทยอีก158รายผงะเจอไข้สูง17รายผลตรวจเ...</td>\n","      <td>0</td>\n","      <td>=GOOGLETRANSLATE(A6,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C6,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2425</th>\n","      <td>กรีดเลือดประท้วงเสี่ยงอันตรายถึงชีวิตทั้งติดเช...</td>\n","      <td>0</td>\n","      <td>=GOOGLETRANSLATE(A2427,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C2427,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>2426</th>\n","      <td>ชอบดื่มกาแฟทุกเช้าไม่ใส่น้ำตาลตอนท้องว่างคือดี...</td>\n","      <td>1</td>\n","      <td>=GOOGLETRANSLATE(A2428,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C2428,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>2427</th>\n","      <td>ไข่มุกปลอมจากยางรถยนตแล้วก้หมูหยองปลอมด้วย</td>\n","      <td>1</td>\n","      <td>=GOOGLETRANSLATE(A2429,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C2429,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>2428</th>\n","      <td>ศบค.หวั่นธรรมเนียมจกข้าวเหนียวใส่บาตรภาคอีสานเ...</td>\n","      <td>0</td>\n","      <td>=GOOGLETRANSLATE(A2430,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C2430,\"en\",\"th\")</td>\n","    </tr>\n","    <tr>\n","      <th>2429</th>\n","      <td>ผลิตภัณฑ์บำรุงสายตาดีคอนแทคdcontactดีไม้คะhttp...</td>\n","      <td>1</td>\n","      <td>=GOOGLETRANSLATE(A2431,\"th\",\"en\")</td>\n","      <td>=GOOGLETRANSLATE(C2431,\"en\",\"th\")</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2430 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e8b1a8bb-db07-4537-84e7-9b3ddc3b850c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e8b1a8bb-db07-4537-84e7-9b3ddc3b850c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e8b1a8bb-db07-4537-84e7-9b3ddc3b850c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["from google.colab import auth\n","auth.authenticate_user()\n","\n","import gspread\n","from google.auth import default\n","creds, _ = default()\n","\n","gc = gspread.authorize(creds)\n","\n","sh = gc.create('train_set_augmented')\n","worksheet = gc.open('train_set_augmented').sheet1\n","worksheet.update([train_set.columns.values.tolist()] + train_set.values.tolist(), value_input_option='USER_ENTERED')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XYdy2ObfI58o","executionInfo":{"status":"ok","timestamp":1654041667544,"user_tz":-420,"elapsed":22686,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"e757b534-6601-4c06-ceb3-f9e3e567d01b"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'spreadsheetId': '1MvVZCZf1er9VHMDPBbtQfYlRg_9Zt4-AWI9ircq3oCE',\n"," 'updatedCells': 9724,\n"," 'updatedColumns': 4,\n"," 'updatedRange': \"'ชีต1'!A1:D2431\",\n"," 'updatedRows': 2431}"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["import time\n","time.sleep(600)"],"metadata":{"id":"UaBx8huTbRji","executionInfo":{"status":"ok","timestamp":1654042267701,"user_tz":-420,"elapsed":600164,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["train_set_augmented = pd.DataFrame(worksheet.get_all_records())\n","train_set_augmented"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":468},"id":"2v4YgOJZUdim","executionInfo":{"status":"ok","timestamp":1654042282931,"user_tz":-420,"elapsed":15235,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"15d2957b-a985-45a6-f0cf-063b06d86120"},"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                   text  labels  \\\n","0     วิธีทำหัวปลีกล้วยน้ำว้ากับสูตรแก้โรคเบาหวาน|||...       1   \n","1     สูงวัยกินถูกหลักโภชนาการสุขภาพดีอายุยืน|||[Kai...       0   \n","2                         ไข่มุกไม่ย่อยแม่จ้าวววแย่แล้ว       1   \n","3     ไม่เชื่อก็ต้องลอง!!สูตรลดน้ำหนักง่ายๆด้วยโซดา+...       1   \n","4     ผีน้อยกลับไทยอีก158รายผงะเจอไข้สูง17รายผลตรวจเ...       0   \n","...                                                 ...     ...   \n","2425  กรีดเลือดประท้วงเสี่ยงอันตรายถึงชีวิตทั้งติดเช...       0   \n","2426  ชอบดื่มกาแฟทุกเช้าไม่ใส่น้ำตาลตอนท้องว่างคือดี...       1   \n","2427         ไข่มุกปลอมจากยางรถยนตแล้วก้หมูหยองปลอมด้วย       1   \n","2428  ศบค.หวั่นธรรมเนียมจกข้าวเหนียวใส่บาตรภาคอีสานเ...       0   \n","2429  ผลิตภัณฑ์บำรุงสายตาดีคอนแทคdcontactดีไม้คะhttp...       1   \n","\n","                                                  th_en  \\\n","0     How to make a banana banana blossom with the f...   \n","1     Elderly eating, good nutrition, good health ||...   \n","2                     Non -sub -pearl, Mae Zhao is bad.   \n","3     Do not believe, must try !! Simple weight loss...   \n","4     158 little ghosts back to Thailand, aback, fou...   \n","...                                                 ...   \n","2425  Sliced ​​blood protest, dangerous, both infect...   \n","2426  I like to drink coffee every morning, not addi...   \n","2427  Fake pearls from the tires and then fake shred...   \n","2428  Sor.P. Dreaded the Dharma Rice with the Northe...   \n","2429  DCONTACT DCONTACT DCONGD. Please ask people wh...   \n","\n","                                              augmented  \n","0     วิธีการทำกล้วยกล้วยด้วยสูตรเพื่อรักษาโรคเบาหวา...  \n","1     การกินผู้สูงอายุโภชนาการที่ดีสุขภาพดี ||| [kai...  \n","2                    ไม่ใช่ -sub -pearl, Mae Zhao ไม่ดี  \n","3     ไม่เชื่อต้องลอง !! สูตรลดน้ำหนักอย่างง่ายด้วยโ...  \n","4     158 Ghosts Little Back to Thailand, Aback พบว่...  \n","...                                                 ...  \n","2425  การประท้วงเลือดหั่นเป็นอันตรายทั้งที่ติดเชื้อแ...  \n","2426  ฉันชอบดื่มกาแฟทุกเช้าไม่เพิ่มน้ำตาลในขณะท้องว่...  \n","2427                  ไข่มุกปลอมจากยางแล้วหมูขูดฝอยปลอม  \n","2428  Sor.P. ขูดข้าวธรรมกับข้าวตะวันออกเฉียงเหนือกับ...  \n","2429  DCONTACT DCONTACT DCONGD โปรดถามคนที่เคยใช้เพื...  \n","\n","[2430 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-2b67fac2-ef55-4198-90c3-6981099cc3a7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>labels</th>\n","      <th>th_en</th>\n","      <th>augmented</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>วิธีทำหัวปลีกล้วยน้ำว้ากับสูตรแก้โรคเบาหวาน|||...</td>\n","      <td>1</td>\n","      <td>How to make a banana banana blossom with the f...</td>\n","      <td>วิธีการทำกล้วยกล้วยด้วยสูตรเพื่อรักษาโรคเบาหวา...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>สูงวัยกินถูกหลักโภชนาการสุขภาพดีอายุยืน|||[Kai...</td>\n","      <td>0</td>\n","      <td>Elderly eating, good nutrition, good health ||...</td>\n","      <td>การกินผู้สูงอายุโภชนาการที่ดีสุขภาพดี ||| [kai...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ไข่มุกไม่ย่อยแม่จ้าวววแย่แล้ว</td>\n","      <td>1</td>\n","      <td>Non -sub -pearl, Mae Zhao is bad.</td>\n","      <td>ไม่ใช่ -sub -pearl, Mae Zhao ไม่ดี</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ไม่เชื่อก็ต้องลอง!!สูตรลดน้ำหนักง่ายๆด้วยโซดา+...</td>\n","      <td>1</td>\n","      <td>Do not believe, must try !! Simple weight loss...</td>\n","      <td>ไม่เชื่อต้องลอง !! สูตรลดน้ำหนักอย่างง่ายด้วยโ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ผีน้อยกลับไทยอีก158รายผงะเจอไข้สูง17รายผลตรวจเ...</td>\n","      <td>0</td>\n","      <td>158 little ghosts back to Thailand, aback, fou...</td>\n","      <td>158 Ghosts Little Back to Thailand, Aback พบว่...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2425</th>\n","      <td>กรีดเลือดประท้วงเสี่ยงอันตรายถึงชีวิตทั้งติดเช...</td>\n","      <td>0</td>\n","      <td>Sliced ​​blood protest, dangerous, both infect...</td>\n","      <td>การประท้วงเลือดหั่นเป็นอันตรายทั้งที่ติดเชื้อแ...</td>\n","    </tr>\n","    <tr>\n","      <th>2426</th>\n","      <td>ชอบดื่มกาแฟทุกเช้าไม่ใส่น้ำตาลตอนท้องว่างคือดี...</td>\n","      <td>1</td>\n","      <td>I like to drink coffee every morning, not addi...</td>\n","      <td>ฉันชอบดื่มกาแฟทุกเช้าไม่เพิ่มน้ำตาลในขณะท้องว่...</td>\n","    </tr>\n","    <tr>\n","      <th>2427</th>\n","      <td>ไข่มุกปลอมจากยางรถยนตแล้วก้หมูหยองปลอมด้วย</td>\n","      <td>1</td>\n","      <td>Fake pearls from the tires and then fake shred...</td>\n","      <td>ไข่มุกปลอมจากยางแล้วหมูขูดฝอยปลอม</td>\n","    </tr>\n","    <tr>\n","      <th>2428</th>\n","      <td>ศบค.หวั่นธรรมเนียมจกข้าวเหนียวใส่บาตรภาคอีสานเ...</td>\n","      <td>0</td>\n","      <td>Sor.P. Dreaded the Dharma Rice with the Northe...</td>\n","      <td>Sor.P. ขูดข้าวธรรมกับข้าวตะวันออกเฉียงเหนือกับ...</td>\n","    </tr>\n","    <tr>\n","      <th>2429</th>\n","      <td>ผลิตภัณฑ์บำรุงสายตาดีคอนแทคdcontactดีไม้คะhttp...</td>\n","      <td>1</td>\n","      <td>DCONTACT DCONTACT DCONGD. Please ask people wh...</td>\n","      <td>DCONTACT DCONTACT DCONGD โปรดถามคนที่เคยใช้เพื...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2430 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2b67fac2-ef55-4198-90c3-6981099cc3a7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2b67fac2-ef55-4198-90c3-6981099cc3a7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2b67fac2-ef55-4198-90c3-6981099cc3a7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["train_set = pd.concat([train_set_augmented[['text','labels']],\\\n","           train_set_augmented[['augmented','labels']].rename(columns = {'augmented':'text'})])"],"metadata":{"id":"caWPn2axWyGw","executionInfo":{"status":"ok","timestamp":1654042282931,"user_tz":-420,"elapsed":6,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["augmented_dataset = DatasetDict({\n","    'train': dataset.from_pandas(train_set),\n","    'test': trainvalid_test['test'],\n","    'valid': train_valid['test']})"],"metadata":{"id":"QS8psMO9Yqgg","executionInfo":{"status":"ok","timestamp":1654042282932,"user_tz":-420,"elapsed":5,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["augmented_dataset.save_to_disk('/content/drive/MyDrive/Fake news/News-Dataset/augmented_dataset')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["934a6aec240b4da792260819cc58e983","2df0d6f0cd8b4a508f28aeeb5be93b53","772393ef42294a91bd19d3c066d78ef0","a3f947eb47004f7e9284abe1a2e8d022","907b5baa2f0e4646ae66f6581346dc41","95a372e9bae8409fbb9cfbf041c11f3e","d890d4f2982645ffa44aa0a6dc04cbde","805ac44ad8f540b4937a5016e87c9b92","fc0c40233f0e4d378c6a061d803e97eb","c1b68d947f954c6d8313ac0454269b37","dbb41fce4bd94ec6b86a563c3d733c27","0cad4f7f6ac74bf9a99341268a8d4684","2ed64d13eb7d43d9ae9cfde1dd4296f4","8f5c8d1d92eb4c7f9294505f76ab5cf7","03e65e72b40a42d98a53c1c95e786b40","430e16efccdc4aa3a1b9d5f954882615","b24ffa1681c54eb78a61e2ee7af33fed","6c600f1391424736b2d346008e4dc984","09c97fc01a95445f8bbda54f33dd49c0","3430327f68a54fa79c3d116ac57b71f0","dcaebdf722214915b22f25d1a53a355d","1a4c1aa6ba9d4660bbc4038d936a1267"]},"id":"EQWQlIRbY1N0","executionInfo":{"status":"ok","timestamp":1654042286403,"user_tz":-420,"elapsed":3476,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}},"outputId":"af0a3982-4b66-4130-c888-b0b72c8b97f4"},"execution_count":18,"outputs":[{"output_type":"display_data","data":{"text/plain":["Flattening the indices:   0%|          | 0/1 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"934a6aec240b4da792260819cc58e983"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Flattening the indices:   0%|          | 0/1 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0cad4f7f6ac74bf9a99341268a8d4684"}},"metadata":{}}]},{"cell_type":"code","source":[""],"metadata":{"id":"0VwqnzThlwci","executionInfo":{"status":"ok","timestamp":1654042286404,"user_tz":-420,"elapsed":9,"user":{"displayName":"Nithiwat Sirirattanachaikul","userId":"08372884157461608587"}}},"execution_count":18,"outputs":[]}]}